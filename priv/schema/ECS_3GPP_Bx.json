{
	"$schema": "http://json-schema.org/draft-07/schema#",
	"$id": "http://sigscale.org/schema/cgf/ECS_3GPP_Bx.json",
	"title": "Elastic Log for the 3GPP Bx interface",
	"$defs": {
		"BxRecord": {
			"$id": "#/$defs/BxRecord",
			"description": "Elastic Stack log format for charging data records (CDR) on the 3GPP Bx interface .",
			"type": "object",
			"allOf": [
				{
					"$ref": "http://sigscale.org/schema/cgf/ECS_base.json#/$defs/ECS_base"
				},
				{
					"$ref": "http://sigscale.org/schema/cgf/ECS_ecs.json#/$defs/ECS_ecs"
				},
				{
					"$ref": "http://sigscale.org/schema/cgf/ECS_service.json#/$defs/ECS_service"
				},
				{
					"$ref": "http://sigscale.org/schema/cgf/ECS_network.json#/$defs/ECS_network"
				},
				{
					"$ref": "http://sigscale.org/schema/cgf/ECS_user.json#/$defs/ECS_user"
				},
				{
					"$ref": "http://sigscale.org/schema/cgf/ECS_event.json#/$defs/ECS_event"
				},
				{
					"properties": {
						"Bx_moCall": {
							"$ref": "http://sigscale.org/schema/cgf/ECS_3GPP_Bx_MOCallRecord.json#/$defs/MOCallRecord"
						}
					}
				},
				{
					"properties": {
						"Bx_mtCall": {
							"$ref": "http://sigscale.org/schema/cgf/ECS_3GPP_Bx_MTCallRecord.json#/$defs/MTCallRecord"
						}
					}
				},
				{
					"properties": {
						"Bx_moSMS": {
							"$ref": "http://sigscale.org/schema/cgf/ECS_3GPP_Bx_MOSMSRecord.json#/$defs/MOSMSRecord"
						}
					}
				},
				{
					"properties": {
						"Bx_mtSMS": {
							"$ref": "http://sigscale.org/schema/cgf/ECS_3GPP_Bx_MTSMSRecord.json#/$defs/MTSMSRecord"
						}
					}
				}
			],
			"examples": [
				{
					"@timestamp": "2024-03-28T12:45:03.692Z",
					"labels": {
						"application": "sigscale-cgf"
					},
					"tags": [],
					"ecs": {
						"version": "8.5"
					},
					"service": {
						"type": "cgf",
						"node": {
							"name": "cgf@host.example.net"
						}
					},
					"user": {
						"name": "msisdn-21584107516",
						"id": "imsi-0010010335668343"
					},
					"event": {
						"start": "2024-03-28T09:13:10.456Z",
						"end": "2024-03-28T09:13:48.789Z",
						"duration": "38000000000",
						"kind": "event",
						"category": [
							"session"
						],
						"type": [
							"protocol",
							"end"
						],
						"outcome": "success"
					},
					"Bx_moCall": {
						"servedIMSI": "001001012345678",
						"calledNumber": {
							"natureOfAddress": "international",
							"numberingPlan": "e164",
							"address": "14165551234"
						},
						"recordingEntity": {
							"natureOfAddress": "international",
							"numberingPlan": "e164",
							"address": "14165550000"
						},
						"location": {
							"locationAreaCode": 42,
							"cellId": 1532,
							"mcc": "001",
							"ncc": "001"
						},
						"basicService": {
							"bearerService": 20
						},
						"msClassmark": [125, 87],
						"seizureTime": "2024-03-28T09:13:00.123Z",
						"answerTime": "2024-03-28T09:13:10.456Z",
						"releaseTime": "2024-03-28T09:13:48.789Z",
						"callDuration": 38,
						"causeForTerm": "normalRelease",
						"callReference": 729081236,
						"systemType": "gERAN"
					}
				}
			]
		}
	}
}
